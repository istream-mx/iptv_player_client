!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.AbsintheSocketApolloLink={})}(this,function(e){"use strict";var n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function i(e,n){return e(n={exports:{}},n.exports),n.exports}var r=t(i(function(e,n){n.__esModule=!0,n.default=function(e,n){if(e!==n)throw new TypeError("Cannot instantiate an arrow function")}})),o=i(function(e,n){!function(e,n){function t(e){return"function"==typeof Symbol&&Boolean(Symbol[e])}function i(e){return t(e)?Symbol[e]:"@@"+e}"function"!=typeof Symbol||Symbol.observable||(Symbol.observable=Symbol("observable"));function r(e,n){var t=e[n];if(null!=t){if("function"!=typeof t)throw new TypeError(t+" is not a function");return t}}function o(e){var n=e.constructor;return void 0!==n&&null===(n=n[i("species")])&&(n=void 0),void 0!==n?n:l}function u(e,n){Object.keys(n).forEach(function(t){var i=Object.getOwnPropertyDescriptor(n,t);i.enumerable=!1,Object.defineProperty(e,t,i)})}function a(e){var n=e._cleanup;n&&(e._cleanup=void 0,n())}function c(e){return void 0===e._observer}function s(e,n){if(Object(e)!==e)throw new TypeError("Observer must be an object");this._cleanup=void 0,this._observer=e;var t=r(e,"start");if(t&&t.call(e,this),!c(this)){e=new f(this);try{var i=n.call(void 0,e);if(null!=i){if("function"==typeof i.unsubscribe)o=i,i=function(){o.unsubscribe()};else if("function"!=typeof i)throw new TypeError(i+" is not a function");this._cleanup=i}}catch(n){return void e.error(n)}var o;c(this)&&a(this)}}u(s.prototype={},{get closed(){return c(this)},unsubscribe:function(){!function(e){c(e)||(e._observer=void 0,a(e))}(this)}});function f(e){this._subscription=e}u(f.prototype={},{get closed(){return c(this._subscription)},next:function(e){var n=this._subscription;if(!c(n)){var t=n._observer,i=r(t,"next");if(i)return i.call(t,e)}},error:function(e){var n=this._subscription;if(c(n))throw e;var t=n._observer;n._observer=void 0;try{var i=r(t,"error");if(!i)throw e;e=i.call(t,e)}catch(e){try{a(n)}finally{throw e}}return a(n),e},complete:function(e){var n=this._subscription;if(!c(n)){var t=n._observer;n._observer=void 0;try{var i=r(t,"complete");e=i?i.call(t,e):void 0}catch(e){try{a(n)}finally{throw e}}return a(n),e}}});function l(e){if("function"!=typeof e)throw new TypeError("Observable initializer must be a function");this._subscriber=e}u(l.prototype,{subscribe:function(e){for(var n=[],t=1;t<arguments.length;++t)n.push(arguments[t]);return"function"==typeof e&&(e={next:e,error:n[0],complete:n[1]}),new s(e,this._subscriber)},forEach:function(e){var n=this;return new Promise(function(t,i){if("function"!=typeof e)return Promise.reject(new TypeError(e+" is not a function"));n.subscribe({_subscription:null,start:function(e){if(Object(e)!==e)throw new TypeError(e+" is not an object");this._subscription=e},next:function(n){var t=this._subscription;if(!t.closed)try{return e(n)}catch(e){i(e),t.unsubscribe()}},error:i,complete:t})})},map:function(e){var n=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var t=o(this);return new t(function(t){return n.subscribe({next:function(n){if(!t.closed){try{n=e(n)}catch(e){return t.error(e)}return t.next(n)}},error:function(e){return t.error(e)},complete:function(e){return t.complete(e)}})})},filter:function(e){var n=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var t=o(this);return new t(function(t){return n.subscribe({next:function(n){if(!t.closed){try{if(!e(n))return}catch(e){return t.error(e)}return t.next(n)}},error:function(e){return t.error(e)},complete:function(){return t.complete()}})})},reduce:function(e){var n=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var t=o(this),i=arguments.length>1,r=!1,u=arguments[1],a=u;return new t(function(t){return n.subscribe({next:function(n){if(!t.closed){var o=!r;if(r=!0,!o||i)try{a=e(a,n)}catch(e){return t.error(e)}else a=n}},error:function(e){t.error(e)},complete:function(){r||i?(t.next(a),t.complete()):t.error(new TypeError("Cannot reduce an empty sequence"))}})})},flatMap:function(e){var n=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var t=o(this);return new t(function(t){var i=!1,r=[],o=n.subscribe({next:function(n){if(e)try{n=e(n)}catch(e){return void t.error(e)}l.from(n).subscribe({_subscription:null,start:function(e){r.push(this._subscription=e)},next:function(e){t.next(e)},error:function(e){t.error(e)},complete:function(){var e=r.indexOf(this._subscription);e>=0&&r.splice(e,1),u()}})},error:function(e){return t.error(e)},complete:function(){i=!0,u()}});function u(){i&&0===r.length&&t.complete()}return function(){r.forEach(function(e){return e.unsubscribe()}),o.unsubscribe()}})}}),Object.defineProperty(l.prototype,i("observable"),{value:function(){return this},writable:!0,configurable:!0}),u(l,{from:function(e){var n="function"==typeof this?this:l;if(null==e)throw new TypeError(e+" is not an object");var o=r(e,i("observable"));if(o){var u=o.call(e);if(Object(u)!==u)throw new TypeError(u+" is not an object");return u.constructor===n?u:new n(function(e){return u.subscribe(e)})}if(t("iterator")&&(o=r(e,i("iterator"))))return new n(function(n){for(var t,i=o.call(e)[Symbol.iterator]();t=i.next(),!t.done;){var r=t.value;if(n.next(r),n.closed)return}n.complete()});if(Array.isArray(e))return new n(function(n){for(var t=0;t<e.length;++t)if(n.next(e[t]),n.closed)return;n.complete()});throw new TypeError(e+" is not observable")},of:function(){for(var e=[],n=0;n<arguments.length;++n)e.push(arguments[n]);var t="function"==typeof this?this:l;return new t(function(n){for(var t=0;t<e.length;++t)if(n.next(e[t]),n.closed)return;n.complete()})}}),Object.defineProperty(l,i("species"),{get:function(){return this},configurable:!0}),e.Observable=l}(n)}).Observable,u=i(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});n.isScalarValue=function(e){return["StringValue","BooleanValue","EnumValue"].indexOf(e.kind)>-1};n.isNumberValue=function(e){return["IntValue","FloatValue"].indexOf(e.kind)>-1};function t(e,n,i,r){if("IntValue"===i.kind||(d=i,"FloatValue"===d.kind))e[n.value]=Number(i.value);else if(l=i,"BooleanValue"===l.kind||(f=i,"StringValue"===f.kind))e[n.value]=i.value;else if(s=i,"ObjectValue"===s.kind){var o={};i.fields.map(function(e){return t(o,e.name,e.value,r)}),e[n.value]=o}else if(c=i,"Variable"===c.kind){var u=(r||{})[i.name.value];e[n.value]=u}else if(a=i,"ListValue"===a.kind)e[n.value]=i.values.map(function(e){var i={};return t(i,n,e,r),i[n.value]});else{if("EnumValue"!==i.kind)throw new Error('The inline argument "'+n.value+'" of kind "'+i.kind+'" is not supported.\n                    Use variables instead of inline arguments to overcome this limitation.');e[n.value]=i.value}var a,c,s,f,l,d}n.valueToObjectRepresentation=t;n.storeKeyNameFromField=function(e,n){var r=null;e.directives&&(r={},e.directives.forEach(function(e){r[e.name.value]={},e.arguments&&e.arguments.forEach(function(i){var o=i.name,u=i.value;return t(r[e.name.value],o,u,n)})}));var o=null;return e.arguments&&e.arguments.length&&(o={},e.arguments.forEach(function(e){var i=e.name,r=e.value;return t(o,i,r,n)})),i(e.name.value,o,r)};function i(e,n,t){if(t&&t.connection&&t.connection.key){if(t.connection.filter&&t.connection.filter.length>0){var i=t.connection.filter?t.connection.filter:[];i.sort();var r=n,o={};return i.forEach(function(e){o[e]=r[e]}),t.connection.key+"("+JSON.stringify(o)+")"}return t.connection.key}if(n){return e+"("+JSON.stringify(n)+")"}return e}n.getStoreKeyName=i;n.argumentsObjectFromField=function(e,n){if(e.arguments&&e.arguments.length){var i={};return e.arguments.forEach(function(e){var r=e.name,o=e.value;return t(i,r,o,n)}),i}return null};n.resultKeyNameFromField=function(e){return e.alias?e.alias.value:e.name.value};n.isField=function(e){return"Field"===e.kind};n.isInlineFragment=function(e){return"InlineFragment"===e.kind};n.isIdValue=function(e){return e&&"id"===e.type};n.toIdValue=function(e,n){return void 0===n&&(n=!1),{type:"id",id:e,generated:n}};n.isJsonValue=function(e){return null!=e&&"object"==typeof e&&"json"===e.type};function r(e){throw new Error("Variable nodes are not supported by valueFromNode")}n.valueFromNode=function e(n,t){switch(void 0===t&&(t=r),n.kind){case"Variable":return t(n);case"NullValue":return null;case"IntValue":return parseInt(n.value);case"FloatValue":return parseFloat(n.value);case"ListValue":return n.values.map(function(n){return e(n,t)});case"ObjectValue":for(var i={},o=0,u=n.fields;o<u.length;o++){var a=u[o];i[a.name.value]=e(a.value,t)}return i;default:return n.value}}});t(u);u.isScalarValue,u.isNumberValue,u.valueToObjectRepresentation,u.storeKeyNameFromField,u.getStoreKeyName,u.argumentsObjectFromField,u.resultKeyNameFromField,u.isField,u.isInlineFragment,u.isIdValue,u.toIdValue,u.isJsonValue,u.valueFromNode;var a=i(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});n.getDirectiveInfoFromField=function(e,n){if(e.directives&&e.directives.length){var t={};return e.directives.forEach(function(e){t[e.name.value]=u.argumentsObjectFromField(e,n)}),t}return null};n.shouldInclude=function(e,n){if(void 0===n&&(n={}),!e.directives)return!0;var t=!0;return e.directives.forEach(function(e){if("skip"===e.name.value||"include"===e.name.value){var i=e.arguments||[],r=e.name.value;if(1!==i.length)throw new Error("Incorrect number of arguments for the @"+r+" directive.");var o=i[0];if(!o.name||"if"!==o.name.value)throw new Error("Invalid argument for the @"+r+" directive.");var u=i[0].value,a=!1;if(u&&"BooleanValue"===u.kind)a=u.value;else{if("Variable"!==u.kind)throw new Error("Argument for the @"+r+" directive must be a variable or a bool ean value.");if(void 0===(a=n[u.name.value]))throw new Error("Invalid variable referenced in @"+r+" directive.")}"skip"===r&&(a=!a),a||(t=!1)}}),t};function t(e){return e.selectionSet&&e.selectionSet.selections.length>0?[e].concat(e.selectionSet.selections.map(function(e){return[e].concat(t(e))}).reduce(function(e,n){return e.concat(n)},[])):[e]}n.flattenSelections=t;var i=new Map;function r(e){var n=i.get(e);if(n)return n;var r=e.definitions.filter(function(e){return e.selectionSet&&e.selectionSet.selections}).map(function(e){return t(e)}).reduce(function(e,n){return e.concat(n)},[]).filter(function(e){return e.directives&&e.directives.length>0}).map(function(e){return e.directives}).reduce(function(e,n){return e.concat(n)},[]).map(function(e){return e.name.value});return i.set(e,r),r}n.getDirectiveNames=r;n.hasDirectives=function(e,n){return r(n).some(function(n){return e.indexOf(n)>-1})}});t(a);a.getDirectiveInfoFromField,a.shouldInclude,a.flattenSelections,a.getDirectiveNames,a.hasDirectives;var c=i(function(e,t){var i=n&&n.__assign||Object.assign||function(e){for(var n,t=1,i=arguments.length;t<i;t++){n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};Object.defineProperty(t,"__esModule",{value:!0});t.getFragmentQueryDocument=function(e,n){var t=n,r=[];if(e.definitions.forEach(function(e){if("OperationDefinition"===e.kind)throw new Error("Found a "+e.operation+" operation"+(e.name?" named '"+e.name.value+"'":"")+". No operations are allowed when using a fragment as a query. Only fragments are allowed.");"FragmentDefinition"===e.kind&&r.push(e)}),void 0===t){if(1!==r.length)throw new Error("Found "+r.length+" fragments. `fragmentName` must be provided when there is not exactly 1 fragment.");t=r[0].name.value}return i({},e,{definitions:[{kind:"OperationDefinition",operation:"query",selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:t}}]}}].concat(e.definitions)})}});t(c);c.getFragmentQueryDocument;var s=i(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});n.assign=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];return n.forEach(function(n){void 0!==n&&null!==n&&Object.keys(n).forEach(function(t){e[t]=n[t]})}),e}});t(s);s.assign;var f=i(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});n.getMutationDefinition=function(e){t(e);var n=e.definitions.filter(function(e){return"OperationDefinition"===e.kind&&"mutation"===e.operation})[0];if(!n)throw new Error("Must contain a mutation definition.");return n};function t(e){if("Document"!==e.kind)throw new Error('Expecting a parsed GraphQL document. Perhaps you need to wrap the query string in a "gql" tag? http://docs.apollostack.com/apollo-client/core.html#gql');var n=e.definitions.filter(function(e){return"FragmentDefinition"!==e.kind}).map(function(e){if("OperationDefinition"!==e.kind)throw new Error('Schema type definitions not allowed in queries. Found: "'+e.kind+'"');return e});if(n.length>1)throw new Error("Ambiguous GraphQL document: contains "+n.length+" operations")}n.checkDocument=t;function i(e){return t(e),e.definitions.filter(function(e){return"OperationDefinition"===e.kind})[0]}n.getOperationDefinition=i;n.getOperationDefinitionOrDie=function(e){var n=i(e);if(!n)throw new Error("GraphQL document is missing an operation");return n};n.getOperationName=function(e){return e.definitions.filter(function(e){return"OperationDefinition"===e.kind&&e.name}).map(function(e){return e.name.value})[0]||null};n.getFragmentDefinitions=function(e){return e.definitions.filter(function(e){return"FragmentDefinition"===e.kind})};n.getQueryDefinition=function(e){var n=i(e);if(!n||"query"!==n.operation)throw new Error("Must contain a query definition.");return n};n.getFragmentDefinition=function(e){if("Document"!==e.kind)throw new Error('Expecting a parsed GraphQL document. Perhaps you need to wrap the query string in a "gql" tag? http://docs.apollostack.com/apollo-client/core.html#gql');if(e.definitions.length>1)throw new Error("Fragment must have exactly one definition.");var n=e.definitions[0];if("FragmentDefinition"!==n.kind)throw new Error("Must be a fragment definition.");return n};n.getMainDefinition=function(e){t(e);for(var n,i=0,r=e.definitions;i<r.length;i++){var o=r[i];if("OperationDefinition"===o.kind){var u=o.operation;if("query"===u||"mutation"===u||"subscription"===u)return o}"FragmentDefinition"!==o.kind||n||(n=o)}if(n)return n;throw new Error("Expected a parsed GraphQL query with a query, mutation, subscription, or a fragment.")};n.createFragmentMap=function(e){void 0===e&&(e=[]);var n={};return e.forEach(function(e){n[e.name.value]=e}),n};n.getDefaultValues=function(e){if(e&&e.variableDefinitions&&e.variableDefinitions.length){var n=e.variableDefinitions.filter(function(e){return e.defaultValue}).map(function(e){var n=e.variable,t=e.defaultValue,i={};return u.valueToObjectRepresentation(i,n.name,t),i});return s.assign.apply(void 0,[{}].concat(n))}return{}};n.variablesInOperation=function(e){var n=new Set;if(e.variableDefinitions)for(var t=0,i=e.variableDefinitions;t<i.length;t++){var r=i[t];n.add(r.variable.name.value)}return n}});t(f);f.getMutationDefinition,f.checkDocument,f.getOperationDefinition,f.getOperationDefinitionOrDie,f.getOperationName,f.getFragmentDefinitions,f.getQueryDefinition,f.getFragmentDefinition,f.getMainDefinition,f.createFragmentMap,f.getDefaultValues,f.variablesInOperation;var l=i(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});n.cloneDeep=function e(n){if(Array.isArray(n))return n.map(function(n){return e(n)});if(null!==n&&"object"==typeof n){var t={};for(var i in n)n.hasOwnProperty(i)&&(t[i]=e(n[i]));return t}return n}});t(l);l.cloneDeep;var d=i(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t={kind:"Field",name:{kind:"Name",value:"__typename"}};function i(e,n){var t=l.cloneDeep(n);return t.definitions.forEach(function(n){!function e(n,t){return t.selections?(t.selections.forEach(function(e){"Field"===e.kind&&e&&e.directives&&(e.directives=e.directives.filter(function(e){return!n.some(function(n){return!(!n.name||n.name!==e.name.value)||!(!n.test||!n.test(e))})}))}),t.selections.forEach(function(t){"Field"!==t.kind&&"InlineFragment"!==t.kind||!t.selectionSet||e(n,t.selectionSet)}),t):t}(e,n.selectionSet)}),t}n.removeDirectivesFromDocument=i;var r=new Map;n.addTypenameToDocument=function(e){f.checkDocument(e);var n=r.get(e);if(n)return n;var i=l.cloneDeep(e);return i.definitions.forEach(function(e){var n="OperationDefinition"===e.kind;!function e(n,i){void 0===i&&(i=!1),n.selections&&(i||n.selections.some(function(e){return"Field"===e.kind&&"__typename"===e.name.value})||n.selections.push(t),n.selections.forEach(function(n){"Field"===n.kind?0!==n.name.value.lastIndexOf("__",0)&&n.selectionSet&&e(n.selectionSet):"InlineFragment"===n.kind&&n.selectionSet&&e(n.selectionSet)}))}(e.selectionSet,n)}),r.set(e,i),i};var o={test:function(e){var n="connection"===e.name.value;return n&&(e.arguments&&e.arguments.some(function(e){return"key"===e.name.value})||console.warn("Removing an @connection directive even though it does not have a key. You may want to use the key parameter to specify a store key.")),n}},u=new Map;n.removeConnectionDirectiveFromDocument=function(e){f.checkDocument(e);var n=u.get(e);if(n)return n;var t=i([o],e);return u.set(e,t),t}});t(d);d.removeDirectivesFromDocument,d.addTypenameToDocument,d.removeConnectionDirectiveFromDocument;var v=i(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});function t(){return"undefined"!=typeof process&&process.env.NODE_ENV?process.env.NODE_ENV:"development"}n.getEnv=t;function i(e){return t()===e}n.isEnv=i;n.isProduction=function(){return!0===i("production")};n.isDevelopment=function(){return!0===i("development")};n.isTest=function(){return!0===i("test")}});t(v);v.getEnv,v.isEnv,v.isProduction,v.isDevelopment,v.isTest;var h=i(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});n.tryFunctionOrLogError=function(e){try{return e()}catch(e){console.error&&console.error(e)}};n.graphQLResultHasError=function(e){return e.errors&&e.errors.length}});t(h);h.tryFunctionOrLogError,h.graphQLResultHasError;var p=i(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});n.isEqual=function e(n,t){if(n===t)return!0;if(n instanceof Date&&t instanceof Date)return n.getTime()===t.getTime();if(null!=n&&"object"==typeof n&&null!=t&&"object"==typeof t){for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){if(!Object.prototype.hasOwnProperty.call(t,i))return!1;if(!e(n[i],t[i]))return!1}for(var i in t)if(!Object.prototype.hasOwnProperty.call(n,i))return!1;return!0}return!1}});t(p);p.isEqual;var y=i(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});n.maybeDeepFreeze=function(e){return v.isDevelopment()||v.isTest()?function e(n){return Object.freeze(n),Object.getOwnPropertyNames(n).forEach(function(t){!n.hasOwnProperty(t)||null===n[t]||"object"!=typeof n[t]&&"function"!=typeof n[t]||Object.isFrozen(n[t])||e(n[t])}),n}(e):e}});t(y);y.maybeDeepFreeze;var m=i(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t=Object.create({});n.warnOnceInDevelopment=function(e,n){if(void 0===n&&(n="warn"),!v.isProduction()&&!t[e])switch(v.isTest()||(t[e]=!0),n){case"error":console.error(e);break;default:console.warn(e)}}});t(m);m.warnOnceInDevelopment;var b=i(function(e,n){function t(e){for(var t in e)n.hasOwnProperty(t)||(n[t]=e[t])}Object.defineProperty(n,"__esModule",{value:!0}),t(a),t(c),t(f),t(d),t(u),t(s),t(l),t(v),t(h),t(p),t(y),t(m)});t(b);b.addTypenameToDocument,b.argumentsObjectFromField,b.assign,b.checkDocument,b.cloneDeep,b.createFragmentMap,b.flattenSelections,b.getDefaultValues,b.getDirectiveInfoFromField,b.getDirectiveNames,b.getEnv,b.getFragmentDefinition,b.getFragmentDefinitions,b.getFragmentQueryDocument,b.getMainDefinition,b.getMutationDefinition,b.getOperationDefinition,b.getOperationDefinitionOrDie,b.getOperationName,b.getQueryDefinition,b.getStoreKeyName,b.graphQLResultHasError,b.hasDirectives,b.isDevelopment,b.isEnv,b.isEqual,b.isField,b.isIdValue,b.isInlineFragment,b.isJsonValue,b.isNumberValue,b.isProduction,b.isScalarValue,b.isTest,b.maybeDeepFreeze,b.removeConnectionDirectiveFromDocument,b.removeDirectivesFromDocument,b.resultKeyNameFromField,b.shouldInclude,b.storeKeyNameFromField,b.toIdValue,b.tryFunctionOrLogError,b.valueFromNode,b.valueToObjectRepresentation,b.variablesInOperation,b.warnOnceInDevelopment;var g=i(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.visit=function(e,n,u){var a=u||t,c=void 0,s=Array.isArray(e),f=[e],l=-1,d=[],v=void 0,h=[],p=[],y=e;do{var m=++l===f.length,b=void 0,g=void 0,w=m&&0!==d.length;if(m){if(b=0===p.length?void 0:h.pop(),g=v,v=p.pop(),w){if(s)g=g.slice();else{var O={};for(var k in g)g.hasOwnProperty(k)&&(O[k]=g[k]);g=O}for(var j=0,E=0;E<d.length;E++){var S=d[E][0],_=d[E][1];s&&(S-=j),s&&null===_?(g.splice(S,1),j++):g[S]=_}}l=c.index,f=c.keys,d=c.edits,s=c.inArray,c=c.prev}else{if(b=v?s?l:f[l]:void 0,null===(g=v?v[b]:y)||void 0===g)continue;v&&h.push(b)}var D=void 0;if(!Array.isArray(g)){if(!r(g))throw new Error("Invalid AST Node: "+JSON.stringify(g));var T=o(n,g.kind,m);if(T){if((D=T.call(n,g,b,v,h,p))===i)break;if(!1===D){if(!m){h.pop();continue}}else if(void 0!==D&&(d.push([b,D]),!m)){if(!r(D)){h.pop();continue}g=D}}}void 0===D&&w&&d.push([b,g]),m||(c={inArray:s,index:l,keys:f,edits:d,prev:c},s=Array.isArray(g),f=s?g:a[g.kind]||[],l=-1,d=[],v&&p.push(v),v=g)}while(void 0!==c);0!==d.length&&(y=d[d.length-1][1]);return y},n.visitInParallel=function(e){var n=new Array(e.length);return{enter:function(t){for(var r=0;r<e.length;r++)if(!n[r]){var u=o(e[r],t.kind,!1);if(u){var a=u.apply(e[r],arguments);if(!1===a)n[r]=t;else if(a===i)n[r]=i;else if(void 0!==a)return a}}},leave:function(t){for(var r=0;r<e.length;r++)if(n[r])n[r]===t&&(n[r]=null);else{var u=o(e[r],t.kind,!0);if(u){var a=u.apply(e[r],arguments);if(a===i)n[r]=i;else if(void 0!==a&&!1!==a)return a}}}}},n.visitWithTypeInfo=function(e,n){return{enter:function(t){e.enter(t);var i=o(n,t.kind,!1);if(i){var u=i.apply(n,arguments);return void 0!==u&&(e.leave(t),r(u)&&e.enter(u)),u}},leave:function(t){var i=o(n,t.kind,!0),r=void 0;return i&&(r=i.apply(n,arguments)),e.leave(t),r}}},n.getVisitFn=o;var t=n.QueryDocumentKeys={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["name","directives"],ObjectTypeDefinition:["name","interfaces","directives","fields"],FieldDefinition:["name","arguments","type","directives"],InputValueDefinition:["name","type","defaultValue","directives"],InterfaceTypeDefinition:["name","directives","fields"],UnionTypeDefinition:["name","directives","types"],EnumTypeDefinition:["name","directives","values"],EnumValueDefinition:["name","directives"],InputObjectTypeDefinition:["name","directives","fields"],TypeExtensionDefinition:["definition"],DirectiveDefinition:["name","arguments","locations"]},i=n.BREAK={};function r(e){return e&&"string"==typeof e.kind}function o(e,n,t){var i=e[n];if(i){if(!t&&"function"==typeof i)return i;var r=t?i.leave:i.enter;if("function"==typeof r)return r}else{var o=t?e.leave:e.enter;if(o){if("function"==typeof o)return o;var u=o[n];if("function"==typeof u)return u}}}});t(g);g.visit,g.visitInParallel,g.visitWithTypeInfo,g.getVisitFn,g.QueryDocumentKeys,g.BREAK;var w=i(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.print=function(e){return(0,g.visit)(e,{leave:t})};var t={Name:function(e){return e.value},Variable:function(e){return"$"+e.name},Document:function(e){return i(e.definitions,"\n\n")+"\n"},OperationDefinition:function(e){var n=e.operation,t=e.name,r=o("(",i(e.variableDefinitions,", "),")"),u=i(e.directives," "),a=e.selectionSet;return t||u||r||"query"!==n?i([n,i([t,r]),u,a]," "):a},VariableDefinition:function(e){return e.variable+": "+e.type+o(" = ",e.defaultValue)},SelectionSet:function(e){return r(e.selections)},Field:function(e){var n=e.alias,t=e.name,r=e.arguments,u=e.directives,a=e.selectionSet;return i([o("",n,": ")+t+o("(",i(r,", "),")"),i(u," "),a]," ")},Argument:function(e){return e.name+": "+e.value},FragmentSpread:function(e){return"..."+e.name+o(" ",i(e.directives," "))},InlineFragment:function(e){var n=e.typeCondition,t=e.directives,r=e.selectionSet;return i(["...",o("on ",n),i(t," "),r]," ")},FragmentDefinition:function(e){var n=e.name,t=e.typeCondition,r=e.directives,u=e.selectionSet;return"fragment "+n+" on "+t+" "+o("",i(r," ")," ")+u},IntValue:function(e){return e.value},FloatValue:function(e){return e.value},StringValue:function(e){var n=e.value;return JSON.stringify(n)},BooleanValue:function(e){var n=e.value;return JSON.stringify(n)},NullValue:function(){return"null"},EnumValue:function(e){return e.value},ListValue:function(e){return"["+i(e.values,", ")+"]"},ObjectValue:function(e){return"{"+i(e.fields,", ")+"}"},ObjectField:function(e){return e.name+": "+e.value},Directive:function(e){return"@"+e.name+o("(",i(e.arguments,", "),")")},NamedType:function(e){return e.name},ListType:function(e){return"["+e.type+"]"},NonNullType:function(e){return e.type+"!"},SchemaDefinition:function(e){var n=e.directives,t=e.operationTypes;return i(["schema",i(n," "),r(t)]," ")},OperationTypeDefinition:function(e){return e.operation+": "+e.type},ScalarTypeDefinition:function(e){return i(["scalar",e.name,i(e.directives," ")]," ")},ObjectTypeDefinition:function(e){var n=e.name,t=e.interfaces,u=e.directives,a=e.fields;return i(["type",n,o("implements ",i(t,", ")),i(u," "),r(a)]," ")},FieldDefinition:function(e){var n=e.name,t=e.arguments,r=e.type,u=e.directives;return n+o("(",i(t,", "),")")+": "+r+o(" ",i(u," "))},InputValueDefinition:function(e){var n=e.name,t=e.type,r=e.defaultValue,u=e.directives;return i([n+": "+t,o("= ",r),i(u," ")]," ")},InterfaceTypeDefinition:function(e){var n=e.name,t=e.directives,o=e.fields;return i(["interface",n,i(t," "),r(o)]," ")},UnionTypeDefinition:function(e){var n=e.name,t=e.directives,r=e.types;return i(["union",n,i(t," "),"= "+i(r," | ")]," ")},EnumTypeDefinition:function(e){var n=e.name,t=e.directives,o=e.values;return i(["enum",n,i(t," "),r(o)]," ")},EnumValueDefinition:function(e){return i([e.name,i(e.directives," ")]," ")},InputObjectTypeDefinition:function(e){var n=e.name,t=e.directives,o=e.fields;return i(["input",n,i(t," "),r(o)]," ")},TypeExtensionDefinition:function(e){return"extend "+e.definition},DirectiveDefinition:function(e){var n=e.name,t=e.arguments,r=e.locations;return"directive @"+n+o("(",i(t,", "),")")+" on "+i(r," | ")}};function i(e,n){return e?e.filter(function(e){return e}).join(n||""):""}function r(e){return e&&0!==e.length?((n="{\n"+i(e,"\n"))&&n.replace(/\n/g,"\n  "))+"\n}":"{}";var n}function o(e,n,t){return n?e+n+(t||""):""}});t(w);var O=w.print,k=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])};return function(n,t){e(n,t);function i(){this.constructor=n}n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),j=(Object.assign,function(e){k(n,e);function n(n,t){var i=e.call(this,n)||this;return i.link=t,i}return n}(Error));function E(e){return e.request.length<=1}var S=function(e,n){return n?n(e):(void 0)()},_=function(e){return"function"==typeof e?new P(e):e},D=function(){return new P(function(e,n){return(void 0)()})},T=function(e){return 0===e.length?D():e.map(_).reduce(function(e,n){return e.concat(n)})},F=function(e,n,t){void 0===t&&(t=new P(S));var i=_(n),r=_(t);return E(i)&&E(r)?new P(function(n){return e(n)?i.request(n)||(void 0)():r.request(n)||(void 0)()}):new P(function(n,t){return e(n)?i.request(n,t)||(void 0)():r.request(n,t)||(void 0)()})},P=function(){function e(e){e&&(this.request=e)}return e.prototype.split=function(n,t,i){return void 0===i&&(i=new e(S)),this.concat(F(n,t,i))},e.prototype.concat=function(e){return function(e,n){var t=_(e);if(E(t))return console.warn(new j("You are calling concat on a terminating link, which will have no effect",t)),t;var i=_(n);return E(i)?new P(function(e){return t.request(e,function(e){return i.request(e)||(void 0)()})||(void 0)()}):new P(function(e,n){return t.request(e,function(e){return i.request(e,n)||(void 0)()})||(void 0)()})}(this,e)},e.prototype.request=function(e,n){throw new Error("request is not implemented")},e.empty=D,e.from=T,e.split=F,e}(),A=i(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.flip=function(e){return function(n,t){return e(t,n)}},n.constant=function(e){return function(){return e}},n.on=function(e,n){return function(t,i){return e(n(t),n(i))}},n.compose=function(){for(var e=this,n=arguments.length,t=Array(n),i=0;i<n;i++)t[i]=arguments[i];var r=t.length-1;return function(n){for(var i=n,o=r;o>-1;o--)i=t[o].call(e,i);return i}},n.pipe=function(){for(var e=this,n=arguments.length,t=Array(n),i=0;i<n;i++)t[i]=arguments[i];var r=t.length-1;return function(n){for(var i=n,o=0;o<=r;o++)i=t[o].call(e,i);return i}},n.curry=function(e){return function e(n,t,i){return function(){var r=i.concat(Array.prototype.slice.call(arguments));return r.length>=t?n.apply(this,r):e(n,t,r)}}(e,e.length,[])}});t(A);A.flip,A.constant,A.on,A.compose,A.pipe;var M=A.curry,x=Math.ceil,I=Math.floor,N=function(e){return isNaN(e=+e)?0:(e>0?I:x)(e)},C=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e},V=i(function(e){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)}),R=i(function(e){var n=e.exports={version:"2.5.1"};"number"==typeof __e&&(__e=n)}),q=(R.version,function(e,n,t){if(function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!")}(e),void 0===n)return e;switch(t){case 1:return function(t){return e.call(n,t)};case 2:return function(t,i){return e.call(n,t,i)};case 3:return function(t,i,r){return e.call(n,t,i,r)}}return function(){return e.apply(n,arguments)}}),L=function(e){return"object"==typeof e?null!==e:"function"==typeof e},J=function(e){if(!L(e))throw TypeError(e+" is not an object!");return e},H=function(e){try{return!!e()}catch(e){return!0}},B=!H(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),K=V.document,Q=L(K)&&L(K.createElement),U=function(e){return Q?K.createElement(e):{}},G=!B&&!H(function(){return 7!=Object.defineProperty(U("div"),"a",{get:function(){return 7}}).a}),z=function(e,n){if(!L(e))return e;var t,i;if(n&&"function"==typeof(t=e.toString)&&!L(i=t.call(e)))return i;if("function"==typeof(t=e.valueOf)&&!L(i=t.call(e)))return i;if(!n&&"function"==typeof(t=e.toString)&&!L(i=t.call(e)))return i;throw TypeError("Can't convert object to primitive value")},W=Object.defineProperty,X={f:B?Object.defineProperty:function(e,n,t){if(J(e),n=z(n,!0),J(t),G)try{return W(e,n,t)}catch(e){}if("get"in t||"set"in t)throw TypeError("Accessors not supported!");return"value"in t&&(e[n]=t.value),e}},Y=function(e,n){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:n}},$=B?function(e,n,t){return X.f(e,n,Y(1,t))}:function(e,n,t){return e[n]=t,e},Z="prototype",ee=function(e,n,t){var i,r,o,u=e&ee.F,a=e&ee.G,c=e&ee.S,s=e&ee.P,f=e&ee.B,l=e&ee.W,d=a?R:R[n]||(R[n]={}),v=d[Z],h=a?V:c?V[n]:(V[n]||{})[Z];a&&(t=n);for(i in t)(r=!u&&h&&void 0!==h[i])&&i in d||(o=r?h[i]:t[i],d[i]=a&&"function"!=typeof h[i]?t[i]:f&&r?q(o,V):l&&h[i]==o?function(e){var n=function(n,t,i){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(n);case 2:return new e(n,t)}return new e(n,t,i)}return e.apply(this,arguments)};return n[Z]=e[Z],n}(o):s&&"function"==typeof o?q(Function.call,o):o,s&&((d.virtual||(d.virtual={}))[i]=o,e&ee.R&&v&&!v[i]&&$(v,i,o)))};ee.F=1,ee.G=2,ee.S=4,ee.P=8,ee.B=16,ee.W=32,ee.U=64,ee.R=128;var ne,te=ee,ie=$,re={}.hasOwnProperty,oe=function(e,n){return re.call(e,n)},ue={},ae={}.toString,ce=function(e){return ae.call(e).slice(8,-1)},se=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==ce(e)?e.split(""):Object(e)},fe=function(e){return se(C(e))},le=Math.min,de=function(e){return e>0?le(N(e),9007199254740991):0},ve=Math.max,he=Math.min,pe="__core-js_shared__",ye=V[pe]||(V[pe]={}),me=function(e){return ye[e]||(ye[e]={})},be=0,ge=Math.random(),we=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++be+ge).toString(36))},Oe=me("keys"),ke=function(e){return Oe[e]||(Oe[e]=we(e))},je=(ne=!1,function(e,n,t){var i,r,o,u=fe(e),a=de(u.length),c=(i=t,r=a,(i=N(i))<0?ve(i+r,0):he(i,r));if(ne&&n!=n){for(;a>c;)if((o=u[c++])!=o)return!0}else for(;a>c;c++)if((ne||c in u)&&u[c]===n)return ne||c||0;return!ne&&-1}),Ee=ke("IE_PROTO"),Se=function(e,n){var t,i=fe(e),r=0,o=[];for(t in i)t!=Ee&&oe(i,t)&&o.push(t);for(;n.length>r;)oe(i,t=n[r++])&&(~je(o,t)||o.push(t));return o},_e="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),De=Object.keys||function(e){return Se(e,_e)},Te=B?Object.defineProperties:function(e,n){J(e);for(var t,i=De(n),r=i.length,o=0;r>o;)X.f(e,t=i[o++],n[t]);return e},Fe=V.document,Pe=Fe&&Fe.documentElement,Ae=ke("IE_PROTO"),Me=function(){},xe=function(){var e,n=U("iframe"),t=_e.length;for(n.style.display="none",Pe.appendChild(n),n.src="javascript:",(e=n.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),xe=e.F;t--;)delete xe.prototype[_e[t]];return xe()},Ie=Object.create||function(e,n){var t;return null!==e?(Me.prototype=J(e),t=new Me,Me.prototype=null,t[Ae]=e):t=xe(),void 0===n?t:Te(t,n)},Ne=i(function(e){var n=me("wks"),t=V.Symbol,i="function"==typeof t;(e.exports=function(e){return n[e]||(n[e]=i&&t[e]||(i?t:we)("Symbol."+e))}).store=n}),Ce=X.f,Ve=Ne("toStringTag"),Re=function(e,n,t){e&&!oe(e=t?e:e.prototype,Ve)&&Ce(e,Ve,{configurable:!0,value:n})},qe={};$(qe,Ne("iterator"),function(){return this});var Le,Je=function(e){return Object(C(e))},He=ke("IE_PROTO"),Be=Object.prototype,Ke=Object.getPrototypeOf||function(e){return e=Je(e),oe(e,He)?e[He]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?Be:null},Qe=Ne("iterator"),Ue=!([].keys&&"next"in[].keys()),Ge=function(){return this},ze=function(e,n,t,i,r,o,u){c=n,s=i,(a=t).prototype=Ie(qe,{next:Y(1,s)}),Re(a,c+" Iterator");var a,c,s,f,l,d,v=function(e){if(!Ue&&e in m)return m[e];switch(e){case"keys":case"values":return function(){return new t(this,e)}}return function(){return new t(this,e)}},h=n+" Iterator",p="values"==r,y=!1,m=e.prototype,b=m[Qe]||m["@@iterator"]||r&&m[r],g=b||v(r),w=r?p?v("entries"):g:void 0,O="Array"==n?m.entries||b:b;if(O&&(d=Ke(O.call(new e)))!==Object.prototype&&d.next&&Re(d,h,!0),p&&b&&"values"!==b.name&&(y=!0,g=function(){return b.call(this)}),u&&(Ue||y||!m[Qe])&&$(m,Qe,g),ue[n]=g,ue[h]=Ge,r)if(f={values:p?g:v("values"),keys:o?g:v("keys"),entries:w},u)for(l in f)l in m||ie(m,l,f[l]);else te(te.P+te.F*(Ue||y),n,f);return f},We=(Le=!0,function(e,n){var t,i,r=String(C(e)),o=N(n),u=r.length;return o<0||o>=u?Le?"":void 0:(t=r.charCodeAt(o))<55296||t>56319||o+1===u||(i=r.charCodeAt(o+1))<56320||i>57343?Le?r.charAt(o):t:Le?r.slice(o,o+2):i-56320+(t-55296<<10)+65536});ze(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,n=this._t,t=this._i;return t>=n.length?{value:void 0,done:!0}:(e=We(n,t),this._i+=e.length,{value:e,done:!1})});var Xe=function(e,n,t,i){try{return i?n(J(t)[0],t[1]):n(t)}catch(n){var r=e.return;throw void 0!==r&&J(r.call(e)),n}},Ye=Ne("iterator"),$e=Array.prototype,Ze=function(e,n,t){n in e?X.f(e,n,Y(0,t)):e[n]=t},en=Ne("toStringTag"),nn="Arguments"==ce(function(){return arguments}()),tn=function(e){var n,t,i;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(t=function(e,n){try{return e[n]}catch(e){}}(n=Object(e),en))?t:nn?ce(n):"Object"==(i=ce(n))&&"function"==typeof n.callee?"Arguments":i},rn=Ne("iterator"),on=R.getIteratorMethod=function(e){if(void 0!=e)return e[rn]||e["@@iterator"]||ue[tn(e)]},un=Ne("iterator"),an=!1;try{[7][un]().return=function(){an=!0}}catch(e){}te(te.S+te.F*!function(e,n){if(!n&&!an)return!1;var t=!1;try{var i=[7],r=i[un]();r.next=function(){return{done:t=!0}},i[un]=function(){return r},e(i)}catch(e){}return t}(function(e){}),"Array",{from:function(e){var n,t,i,r,o=Je(e),u="function"==typeof this?this:Array,a=arguments.length,c=a>1?arguments[1]:void 0,s=void 0!==c,f=0,l=on(o);if(s&&(c=q(c,a>2?arguments[2]:void 0,2)),void 0!=l&&(u!=Array||(d=l,void 0===d||ue.Array!==d&&$e[Ye]!==d)))for(r=l.call(o),t=new u;!(i=r.next()).done;f++)Ze(t,f,s?Xe(r,c,[i.value,f],!0):i.value);else for(t=new u(n=de(o.length));n>f;f++)Ze(t,f,s?c(o[f],f):o[f]);var d;return t.length=f,t}});var cn=R.Array.from,sn=i(function(e){e.exports={default:cn,__esModule:!0}}),fn=t(sn),ln=t(i(function(e,n){n.__esModule=!0;var t,i=(t=sn,t&&t.__esModule?t:{default:t});n.default=function(e){if(Array.isArray(e)){for(var n=0,t=Array(e.length);n<e.length;n++)t[n]=e[n];return t}return(0,i.default)(e)}})),dn=i(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.flip=function(e){return function(n,t){return e(t,n)}},n.constant=function(e){return function(){return e}},n.on=function(e,n){return function(t,i){return e(n(t),n(i))}},n.compose=function(){for(var e=this,n=arguments.length,t=Array(n),i=0;i<n;i++)t[i]=arguments[i];var r=t.length-1;return function(n){for(var i=n,o=r;o>-1;o--)i=t[o].call(e,i);return i}},n.pipe=function(){for(var e=this,n=arguments.length,t=Array(n),i=0;i<n;i++)t[i]=arguments[i];var r=t.length-1;return function(n){for(var i=n,o=0;o<=r;o++)i=t[o].call(e,i);return i}},n.curry=function(e){return function e(n,t,i){return function(){var r=i.concat(Array.prototype.slice.call(arguments));return r.length>=t?n.apply(this,r):e(n,t,r)}}(e,e.length,[])}});t(dn);dn.flip,dn.constant,dn.on,dn.compose,dn.pipe;var vn=dn.curry,hn={f:Object.getOwnPropertySymbols},pn={f:{}.propertyIsEnumerable},yn=Object.assign,mn=!yn||H(function(){var e={},n={},t=Symbol(),i="abcdefghijklmnopqrst";return e[t]=7,i.split("").forEach(function(e){n[e]=e}),7!=yn({},e)[t]||Object.keys(yn({},n)).join("")!=i})?function(e,n){for(var t=Je(e),i=arguments.length,r=1,o=hn.f,u=pn.f;i>r;)for(var a,c=se(arguments[r++]),s=o?De(c).concat(o(c)):De(c),f=s.length,l=0;f>l;)u.call(c,a=s[l++])&&(t[a]=c[a]);return t}:yn;te(te.S+te.F,"Object",{assign:mn});var bn=R.Object.assign,gn=i(function(e){e.exports={default:bn,__esModule:!0}});t(gn);var wn=t(i(function(e,n){n.__esModule=!0;var t,i=(t=gn,t&&t.__esModule?t:{default:t});n.default=i.default||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}}));!function(e,n){var t=(R.Object||{})[e]||Object[e],i={};i[e]=n(t),te(te.S+te.F*H(function(){t(1)}),"Object",i)}("keys",function(){return function(e){return De(Je(e))}});var On=R.Object.keys,kn=t(i(function(e){e.exports={default:On,__esModule:!0}})),jn=Math.floor;te(te.S,"Number",{isInteger:function(e){return!L(e)&&isFinite(e)&&jn(e)===e}});var En=R.Number.isInteger,Sn=t(i(function(e){e.exports={default:En,__esModule:!0}})),_n=t(i(function(e,n){n.__esModule=!0,n.default=function(e,n){var t={};for(var i in e)n.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}})),Dn=vn(function(e,n){return r(this,void 0),[].concat(ln(n),ln(e))}.bind(void 0)),Tn=(function(e){return r(this,void 0),Array.isArray(e)?e:[e]}.bind(void 0),vn(function(e,n){return r(this,void 0),n===e.length-1}.bind(void 0))),Fn=(vn(function(e,n){return r(this,void 0),Tn(e,n)?0:n+1}.bind(void 0)),function(e){return r(this,void 0),Math.max.apply(Math,ln(kn(e)))+1}.bind(void 0)),Pn=(function(e){return r(this,void 0),fn("length"in e?e:wn({},e,{length:Fn(e)}))}.bind(void 0),vn(function(e,n,t){return r(this,void 0),[].concat(ln(t.slice(0,e)),ln(n),ln(t.slice(e+1)))}.bind(void 0)),function(e,n){return r(this,void 0),Sn(e)&&e>=n}.bind(void 0)),An=function(e){return r(this,void 0),Pn(Number(e),0)}.bind(void 0),Mn=(function(e){e.length;var n=_n(e,["length"]);return r(this,void 0),kn(n).every(An)}.bind(void 0),vn(function(e,n){return r(this,void 0),[].concat(ln(e),ln(n))}.bind(void 0)),vn(function(e,n,t,i){return r(this,void 0),i.reduce(function(t,i,o){return r(this,void 0),e(i,o,t)?n(t,i,o):t}.bind(this),t)}.bind(void 0)),vn(function(e,n,t,i){r(this,void 0);var o=t;return i.every(function(t,i){r(this,void 0);var u=e(t,i,o);return u&&(o=n(o,t,i)),u}.bind(this)),o}.bind(void 0)),vn(function(e,n,t){return r(this,void 0),[].concat(ln(t.slice(0,e)),ln(t.slice(e+n)))}.bind(void 0))),xn=(vn(function(e,n){return r(this,void 0),[].concat(ln(Array(e))).map(function(){return r(this,void 0),n}.bind(this))}.bind(void 0)),vn(function(e,n,t){return r(this,void 0),[].concat(ln(t.slice(0,e)),ln(n),ln(t.slice(e+n.length)))}.bind(void 0)));vn(function(e,n){return r(this,void 0),n<0?e.length-n:n}.bind(void 0));te(te.S+te.F*!B,"Object",{defineProperty:X.f});var In=R.Object,Nn=function(e,n,t){return In.defineProperty(e,n,t)},Cn=i(function(e){e.exports={default:Nn,__esModule:!0}});t(Cn);var Vn=t(i(function(e,n){n.__esModule=!0;var t,i=(t=Cn,t&&t.__esModule?t:{default:t});n.default=function(e,n,t){return n in e?(0,i.default)(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}})),Rn=function(e,n){return{value:n,done:!!e}};ze(Array,"Array",function(e,n){this._t=fe(e),this._i=0,this._k=n},function(){var e=this._t,n=this._k,t=this._i++;return!e||t>=e.length?(this._t=void 0,Rn(1)):Rn(0,"keys"==n?t:"values"==n?e[t]:[t,e[t]])},"values");ue.Arguments=ue.Array;for(var qn=Ne("toStringTag"),Ln="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),Jn=0;Jn<Ln.length;Jn++){var Hn=Ln[Jn],Bn=V[Hn],Kn=Bn&&Bn.prototype;Kn&&!Kn[qn]&&$(Kn,qn,Hn),ue[Hn]=ue.Array}var Qn=Ne("iterator"),Un=R.isIterable=function(e){var n=Object(e);return void 0!==n[Qn]||"@@iterator"in n||ue.hasOwnProperty(tn(n))},Gn=i(function(e){e.exports={default:Un,__esModule:!0}});t(Gn);var zn=R.getIterator=function(e){var n=on(e);if("function"!=typeof n)throw TypeError(e+" is not iterable!");return J(n.call(e))},Wn=i(function(e){e.exports={default:zn,__esModule:!0}});t(Wn);var Xn,Yn=t(i(function(e,n){n.__esModule=!0;var t=r(Gn),i=r(Wn);function r(e){return e&&e.__esModule?e:{default:e}}n.default=function(){return function(e,n){if(Array.isArray(e))return e;if((0,t.default)(Object(e)))return function(e,n){var t=[],r=!0,o=!1,u=void 0;try{for(var a,c=(0,i.default)(e);!(r=(a=c.next()).done)&&(t.push(a.value),!n||t.length!==n);r=!0);}catch(e){o=!0,u=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw u}}return t}(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()})),$n=pn.f,Zn=(Xn=!0,function(e){for(var n,t=fe(e),i=De(t),r=i.length,o=0,u=[];r>o;)$n.call(t,n=i[o++])&&u.push(Xn?[n,t[n]]:t[n]);return u});te(te.S,"Object",{entries:function(e){return Zn(e)}});var et=R.Object.entries,nt=t(i(function(e){e.exports={default:et,__esModule:!0}})),tt=i(function(e){var n=we("meta"),t=X.f,i=0,r=Object.isExtensible||function(){return!0},o=!H(function(){return r(Object.preventExtensions({}))}),u=function(e){t(e,n,{value:{i:"O"+ ++i,w:{}}})},a=e.exports={KEY:n,NEED:!1,fastKey:function(e,t){if(!L(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!oe(e,n)){if(!r(e))return"F";if(!t)return"E";u(e)}return e[n].i},getWeak:function(e,t){if(!oe(e,n)){if(!r(e))return!0;if(!t)return!1;u(e)}return e[n].w},onFreeze:function(e){return o&&a.NEED&&r(e)&&!oe(e,n)&&u(e),e}}}),it=(tt.KEY,tt.NEED,tt.fastKey,tt.getWeak,tt.onFreeze,{f:Ne}),rt=X.f,ot=function(e){var n=R.Symbol||(R.Symbol={});"_"==e.charAt(0)||e in n||rt(n,e,{value:it.f(e)})},ut=Array.isArray||function(e){return"Array"==ce(e)},at=_e.concat("length","prototype"),ct={f:Object.getOwnPropertyNames||function(e){return Se(e,at)}},st=ct.f,ft={}.toString,lt="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],dt={f:function(e){return lt&&"[object Window]"==ft.call(e)?function(e){try{return st(e)}catch(e){return lt.slice()}}(e):st(fe(e))}},vt=Object.getOwnPropertyDescriptor,ht={f:B?vt:function(e,n){if(e=fe(e),n=z(n,!0),G)try{return vt(e,n)}catch(e){}if(oe(e,n))return Y(!pn.f.call(e,n),e[n])}},pt=tt.KEY,yt=ht.f,mt=X.f,bt=dt.f,gt=V.Symbol,wt=V.JSON,Ot=wt&&wt.stringify,kt="prototype",jt=Ne("_hidden"),Et=Ne("toPrimitive"),St={}.propertyIsEnumerable,_t=me("symbol-registry"),Dt=me("symbols"),Tt=me("op-symbols"),Ft=Object[kt],Pt="function"==typeof gt,At=V.QObject,Mt=!At||!At[kt]||!At[kt].findChild,xt=B&&H(function(){return 7!=Ie(mt({},"a",{get:function(){return mt(this,"a",{value:7}).a}})).a})?function(e,n,t){var i=yt(Ft,n);i&&delete Ft[n],mt(e,n,t),i&&e!==Ft&&mt(Ft,n,i)}:mt,It=function(e){var n=Dt[e]=Ie(gt[kt]);return n._k=e,n},Nt=Pt&&"symbol"==typeof gt.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof gt},Ct=function(e,n,t){return e===Ft&&Ct(Tt,n,t),J(e),n=z(n,!0),J(t),oe(Dt,n)?(t.enumerable?(oe(e,jt)&&e[jt][n]&&(e[jt][n]=!1),t=Ie(t,{enumerable:Y(0,!1)})):(oe(e,jt)||mt(e,jt,Y(1,{})),e[jt][n]=!0),xt(e,n,t)):mt(e,n,t)},Vt=function(e,n){J(e);for(var t,i=function(e){var n=De(e),t=hn.f;if(t)for(var i,r=t(e),o=pn.f,u=0;r.length>u;)o.call(e,i=r[u++])&&n.push(i);return n}(n=fe(n)),r=0,o=i.length;o>r;)Ct(e,t=i[r++],n[t]);return e},Rt=function(e){var n=St.call(this,e=z(e,!0));return!(this===Ft&&oe(Dt,e)&&!oe(Tt,e))&&(!(n||!oe(this,e)||!oe(Dt,e)||oe(this,jt)&&this[jt][e])||n)},qt=function(e,n){if(e=fe(e),n=z(n,!0),e!==Ft||!oe(Dt,n)||oe(Tt,n)){var t=yt(e,n);return!t||!oe(Dt,n)||oe(e,jt)&&e[jt][n]||(t.enumerable=!0),t}},Lt=function(e){for(var n,t=bt(fe(e)),i=[],r=0;t.length>r;)oe(Dt,n=t[r++])||n==jt||n==pt||i.push(n);return i},Jt=function(e){for(var n,t=e===Ft,i=bt(t?Tt:fe(e)),r=[],o=0;i.length>o;)!oe(Dt,n=i[o++])||t&&!oe(Ft,n)||r.push(Dt[n]);return r};Pt||(ie((gt=function(){if(this instanceof gt)throw TypeError("Symbol is not a constructor!");var e=we(arguments.length>0?arguments[0]:void 0),n=function(t){this===Ft&&n.call(Tt,t),oe(this,jt)&&oe(this[jt],e)&&(this[jt][e]=!1),xt(this,e,Y(1,t))};return B&&Mt&&xt(Ft,e,{configurable:!0,set:n}),It(e)})[kt],"toString",function(){return this._k}),ht.f=qt,X.f=Ct,ct.f=dt.f=Lt,pn.f=Rt,hn.f=Jt,it.f=function(e){return It(Ne(e))}),te(te.G+te.W+te.F*!Pt,{Symbol:gt});for(var Ht="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Bt=0;Ht.length>Bt;)Ne(Ht[Bt++]);for(var Kt=De(Ne.store),Qt=0;Kt.length>Qt;)ot(Kt[Qt++]);te(te.S+te.F*!Pt,"Symbol",{for:function(e){return oe(_t,e+="")?_t[e]:_t[e]=gt(e)},keyFor:function(e){if(!Nt(e))throw TypeError(e+" is not a symbol!");for(var n in _t)if(_t[n]===e)return n},useSetter:function(){Mt=!0},useSimple:function(){Mt=!1}}),te(te.S+te.F*!Pt,"Object",{create:function(e,n){return void 0===n?Ie(e):Vt(Ie(e),n)},defineProperty:Ct,defineProperties:Vt,getOwnPropertyDescriptor:qt,getOwnPropertyNames:Lt,getOwnPropertySymbols:Jt}),wt&&te(te.S+te.F*(!Pt||H(function(){var e=gt();return"[null]"!=Ot([e])||"{}"!=Ot({a:e})||"{}"!=Ot(Object(e))})),"JSON",{stringify:function(e){if(void 0!==e&&!Nt(e)){for(var n,t,i=[e],r=1;arguments.length>r;)i.push(arguments[r++]);return"function"==typeof(n=i[1])&&(t=n),!t&&ut(n)||(n=function(e,n){if(t&&(n=t.call(this,e,n)),!Nt(n))return n}),i[1]=n,Ot.apply(wt,i)}}}),gt[kt][Et]||$(gt[kt],Et,gt[kt].valueOf),Re(gt,"Symbol"),Re(Math,"Math",!0),Re(V.JSON,"JSON",!0),ot("asyncIterator"),ot("observable");var Ut=R.Symbol,Gt=t(i(function(e){e.exports={default:Ut,__esModule:!0}})),zt=M(function(e,n){return r(this,void 0),n[e]}.bind(void 0)),Wt=M(function(e,n){return r(this,void 0),Object.prototype.hasOwnProperty.call(n,e)}.bind(void 0)),Xt=function(e,n,t){return r(this,void 0),Tn(n,e)?zt(n[e],t):Wt(n[e],t)?Xt(e+1,n,zt(n[e],t)):void 0}.bind(void 0),Yt=M(function(e,n){return r(this,void 0),0===e.length?void 0:Xt(0,e,n)}.bind(void 0)),$t=function(e){return r(this,void 0),Array.isArray(e)?[].concat(ln(e.keys())):kn(e)}.bind(void 0),Zt=M(function(e,n,t){return r(this,void 0),function e(n,t){if(n===t)return!0;var i,r=Array.isArray(n),o=Array.isArray(t);if(r&&o){if(n.length!=t.length)return!1;for(i=0;i<n.length;i++)if(!e(n[i],t[i]))return!1;return!0}if(r!=o)return!1;if(n&&t&&"object"==typeof n&&"object"==typeof t){var u=Object.keys(n);if(u.length!==Object.keys(t).length)return!1;var a=n instanceof Date,c=t instanceof Date;if(a&&c)return n.getTime()==t.getTime();if(a!=c)return!1;var s=n instanceof RegExp,f=t instanceof RegExp;if(s&&f)return n.toString()==t.toString();if(s!=f)return!1;for(i=0;i<u.length;i++)if(!Object.prototype.hasOwnProperty.call(t,u[i]))return!1;for(i=0;i<u.length;i++)if(!e(n[u[i]],t[u[i]]))return!1;return!0}return!1}(Yt(e,t),n)}.bind(void 0)),ei=M(function(e,n){r(this,void 0);var t=$t(e);return t.length===$t(n).length&&t.every(function(t){return r(this,void 0),Wt(t,n)&&zt(t,e)===zt(t,n)}.bind(this))}.bind(void 0)),ni=function(e,n){return r(this,void 0),nt(n).reduce(function(t,i){var o=Yn(i,2),u=o[0],a=o[1];return r(this,void 0),wn({},t,Vn({},u,e(a,u,n)))}.bind(this),{})}.bind(void 0),ti=M(function(e,n){return r(this,void 0),Array.isArray(n)?n.map(e):ni(e,n)}.bind(void 0)),ii=function(e,n){n[e];var t=_n(n,[e]);return r(this,void 0),t}.bind(void 0),ri=M(function(e,n){return r(this,void 0),Array.isArray(n)?Mn(e,1,n):ii(e,n)}.bind(void 0)),oi=function(e){return r(this,void 0),Array.isArray(e)?[].concat(ln(e)):wn({},e)}.bind(void 0),ui=function(e){r(this,void 0);var n=oi(e);return{origin:n,previous:void 0,current:n}}.bind(void 0),ai=function(e){return r(this,void 0),"number"==typeof e?[]:{}}.bind(void 0),ci=function(e,n,t){return r(this,void 0),Wt(e,t)?oi(zt(e,t)):ai(n)}.bind(void 0),si=function(e,n,t,i){return r(this,void 0),Tn(e,t)?n(zt(e[t],i)):ci(e[t],e[t+1],i)}.bind(void 0),fi=function(e,n,t){return r(this,void 0),t[e]=n,zt(e,t)}.bind(void 0),li=function(e,n,t,i){return r(this,void 0),wn({},i,{current:fi(e[n],t,i.current)})}.bind(void 0),di=function(e,n,t){r(this,void 0);var i=ri(e[n],t.current);return wn({},t,0===n?{current:i,origin:i}:{previous:fi(e[n-1],i,t.previous)})}.bind(void 0),vi=Gt("composite.updateIn.removeAction"),hi=function(e,n,t,i){return r(this,void 0),t===vi?di(e,n,i):li(e,n,t,i)}.bind(void 0),pi=function(e,n){return r(this,void 0),function(t,i,o){return r(this,void 0),hi(e,o,si(e,n,o,t.current),t)}.bind(this)}.bind(void 0),yi=M(function(e,n,t){return r(this,void 0),0===e.length?t:e.reduce(pi(e,n),ui(t)).origin}.bind(void 0));yi.remove=vi;var mi=function(){return r(this,void 0),yi.remove}.bind(void 0),bi=(M(function(e,n){return r(this,void 0),yi(e,mi,n)}.bind(void 0)),M(function(e,n,t){r(this,void 0);var i=oi(t);return i[e]=n,i}.bind(void 0)),M(function(e,n,t){return r(this,void 0),yi(e,function(){return r(this,void 0),n}.bind(this),t)}.bind(void 0)),function(e,n){return r(this,void 0),Boolean(Number(e)^Number(n))}.bind(void 0)),gi=(M(function(e,n){return r(this,void 0),e===n||!bi(Array.isArray(e),Array.isArray(n))&&ei(e,n)}.bind(void 0)),i(function(e,n){!function(e){Object.defineProperty(e,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t=function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,n){var t=[],i=!0,r=!1,o=void 0;try{for(var u,a=e[Symbol.iterator]();!(i=(u=a.next()).done)&&(t.push(u.value),!n||t.length!==n);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}return t}(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(){function e(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,t,i){return t&&e(n.prototype,t),i&&e(n,i),n}}();function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var o={connecting:0,open:1,closing:2,closed:3},u=1e4,a={closed:"closed",errored:"errored",joined:"joined",joining:"joining",leaving:"leaving"},c={close:"phx_close",error:"phx_error",join:"phx_join",reply:"phx_reply",leave:"phx_leave"},s=[c.close,c.error,c.join,c.reply,c.leave],f={longpoll:"longpoll",websocket:"websocket"},l=function(){function e(n,t,i,o){r(this,e),this.channel=n,this.event=t,this.payload=i||{},this.receivedResp=null,this.timeout=o,this.timeoutTimer=null,this.recHooks=[],this.sent=!1}return i(e,[{key:"resend",value:function(e){this.timeout=e,this.reset(),this.send()}},{key:"send",value:function(){this.hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel.joinRef()}))}},{key:"receive",value:function(e,n){return this.hasReceived(e)&&n(this.receivedResp.response),this.recHooks.push({status:e,callback:n}),this}},{key:"reset",value:function(){this.cancelRefEvent(),this.ref=null,this.refEvent=null,this.receivedResp=null,this.sent=!1}},{key:"matchReceive",value:function(e){var n=e.status,t=e.response;e.ref,this.recHooks.filter(function(e){return e.status===n}).forEach(function(e){return e.callback(t)})}},{key:"cancelRefEvent",value:function(){this.refEvent&&this.channel.off(this.refEvent)}},{key:"cancelTimeout",value:function(){clearTimeout(this.timeoutTimer),this.timeoutTimer=null}},{key:"startTimeout",value:function(){var e=this;this.timeoutTimer&&this.cancelTimeout(),this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref),this.channel.on(this.refEvent,function(n){e.cancelRefEvent(),e.cancelTimeout(),e.receivedResp=n,e.matchReceive(n)}),this.timeoutTimer=setTimeout(function(){e.trigger("timeout",{})},this.timeout)}},{key:"hasReceived",value:function(e){return this.receivedResp&&this.receivedResp.status===e}},{key:"trigger",value:function(e,n){this.channel.trigger(this.refEvent,{status:e,response:n})}}]),e}(),d=e.Channel=function(){function e(n,t,i){var o=this;r(this,e),this.state=a.closed,this.topic=n,this.params=t||{},this.socket=i,this.bindings=[],this.timeout=this.socket.timeout,this.joinedOnce=!1,this.joinPush=new l(this,c.join,this.params,this.timeout),this.pushBuffer=[],this.rejoinTimer=new y(function(){return o.rejoinUntilConnected()},this.socket.reconnectAfterMs),this.joinPush.receive("ok",function(){o.state=a.joined,o.rejoinTimer.reset(),o.pushBuffer.forEach(function(e){return e.send()}),o.pushBuffer=[]}),this.onClose(function(){o.rejoinTimer.reset(),o.socket.log("channel","close "+o.topic+" "+o.joinRef()),o.state=a.closed,o.socket.remove(o)}),this.onError(function(e){o.isLeaving()||o.isClosed()||(o.socket.log("channel","error "+o.topic,e),o.state=a.errored,o.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",function(){if(o.isJoining()){o.socket.log("channel","timeout "+o.topic+" ("+o.joinRef()+")",o.joinPush.timeout);var e=new l(o,c.leave,{},o.timeout);e.send(),o.state=a.errored,o.joinPush.reset(),o.rejoinTimer.scheduleTimeout()}}),this.on(c.reply,function(e,n){o.trigger(o.replyEventName(n),e)})}return i(e,[{key:"rejoinUntilConnected",value:function(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this.rejoin()}},{key:"join",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;if(this.joinedOnce)throw"tried to join multiple times. 'join' can only be called a single time per channel instance";return this.joinedOnce=!0,this.rejoin(e),this.joinPush}},{key:"onClose",value:function(e){this.on(c.close,e)}},{key:"onError",value:function(e){this.on(c.error,function(n){return e(n)})}},{key:"on",value:function(e,n){this.bindings.push({event:e,callback:n})}},{key:"off",value:function(e){this.bindings=this.bindings.filter(function(n){return n.event!==e})}},{key:"canPush",value:function(){return this.socket.isConnected()&&this.isJoined()}},{key:"push",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw"tried to push '"+e+"' to '"+this.topic+"' before joining. Use channel.join() before pushing events";var i=new l(this,e,n,t);return this.canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}},{key:"leave",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.state=a.leaving;var t=function(){e.socket.log("channel","leave "+e.topic),e.trigger(c.close,"leave")},i=new l(this,c.leave,{},n);return i.receive("ok",function(){return t()}).receive("timeout",function(){return t()}),i.send(),this.canPush()||i.trigger("ok",{}),i}},{key:"onMessage",value:function(e,n,t){return n}},{key:"isMember",value:function(e,n,t,i){if(this.topic!==e)return!1;var r=s.indexOf(n)>=0;return!i||!r||i===this.joinRef()||(this.socket.log("channel","dropping outdated message",{topic:e,event:n,payload:t,joinRef:i}),!1)}},{key:"joinRef",value:function(){return this.joinPush.ref}},{key:"sendJoin",value:function(e){this.state=a.joining,this.joinPush.resend(e)}},{key:"rejoin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.isLeaving()||this.sendJoin(e)}},{key:"trigger",value:function(e,n,t,i){var r=this,o=this.onMessage(e,n,t,i);if(n&&!o)throw"channel onMessage callbacks must return the payload, modified or unmodified";this.bindings.filter(function(n){return n.event===e}).map(function(e){return e.callback(o,t,i||r.joinRef())})}},{key:"replyEventName",value:function(e){return"chan_reply_"+e}},{key:"isClosed",value:function(){return this.state===a.closed}},{key:"isErrored",value:function(){return this.state===a.errored}},{key:"isJoined",value:function(){return this.state===a.joined}},{key:"isJoining",value:function(){return this.state===a.joining}},{key:"isLeaving",value:function(){return this.state===a.leaving}}]),e}(),v={encode:function(e,n){var t=[e.join_ref,e.ref,e.topic,e.event,e.payload];return n(JSON.stringify(t))},decode:function(e,n){var i=JSON.parse(e),r=t(i,5),o=r[0],u=r[1],a=r[2],c=r[3],s=r[4];return n({join_ref:o,ref:u,topic:a,event:c,payload:s})}},h=(e.Socket=function(){function e(n){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,e),this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.channels=[],this.sendBuffer=[],this.ref=0,this.timeout=i.timeout||u,this.transport=i.transport||window.WebSocket||h,this.defaultEncoder=v.encode,this.defaultDecoder=v.decode,this.transport!==h?(this.encode=i.encode||this.defaultEncoder,this.decode=i.decode||this.defaultDecoder):(this.encode=this.defaultEncoder,this.decode=this.defaultDecoder),this.heartbeatIntervalMs=i.heartbeatIntervalMs||3e4,this.reconnectAfterMs=i.reconnectAfterMs||function(e){return[1e3,2e3,5e3,1e4][e-1]||1e4},this.logger=i.logger||function(){},this.longpollerTimeout=i.longpollerTimeout||2e4,this.params=i.params||{},this.endPoint=n+"/"+f.websocket,this.heartbeatTimer=null,this.pendingHeartbeatRef=null,this.reconnectTimer=new y(function(){t.disconnect(function(){return t.connect()})},this.reconnectAfterMs)}return i(e,[{key:"protocol",value:function(){return location.protocol.match(/^https/)?"wss":"ws"}},{key:"endPointURL",value:function(){var e=p.appendParams(p.appendParams(this.endPoint,this.params),{vsn:"2.0.0"});return"/"!==e.charAt(0)?e:"/"===e.charAt(1)?this.protocol()+":"+e:this.protocol()+"://"+location.host+e}},{key:"disconnect",value:function(e,n,t){this.conn&&(this.conn.onclose=function(){},n?this.conn.close(n,t||""):this.conn.close(),this.conn=null),e&&e()}},{key:"connect",value:function(e){var n=this;e&&(console&&console.log("passing params to connect is deprecated. Instead pass :params to the Socket constructor"),this.params=e),this.conn||(this.conn=new this.transport(this.endPointURL()),this.conn.timeout=this.longpollerTimeout,this.conn.onopen=function(){return n.onConnOpen()},this.conn.onerror=function(e){return n.onConnError(e)},this.conn.onmessage=function(e){return n.onConnMessage(e)},this.conn.onclose=function(e){return n.onConnClose(e)})}},{key:"log",value:function(e,n,t){this.logger(e,n,t)}},{key:"onOpen",value:function(e){this.stateChangeCallbacks.open.push(e)}},{key:"onClose",value:function(e){this.stateChangeCallbacks.close.push(e)}},{key:"onError",value:function(e){this.stateChangeCallbacks.error.push(e)}},{key:"onMessage",value:function(e){this.stateChangeCallbacks.message.push(e)}},{key:"onConnOpen",value:function(){var e=this;this.log("transport","connected to "+this.endPointURL()),this.flushSendBuffer(),this.reconnectTimer.reset(),this.conn.skipHeartbeat||(clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(function(){return e.sendHeartbeat()},this.heartbeatIntervalMs)),this.stateChangeCallbacks.open.forEach(function(e){return e()})}},{key:"onConnClose",value:function(e){this.log("transport","close",e),this.triggerChanError(),clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(function(n){return n(e)})}},{key:"onConnError",value:function(e){this.log("transport",e),this.triggerChanError(),this.stateChangeCallbacks.error.forEach(function(n){return n(e)})}},{key:"triggerChanError",value:function(){this.channels.forEach(function(e){return e.trigger(c.error)})}},{key:"connectionState",value:function(){switch(this.conn&&this.conn.readyState){case o.connecting:return"connecting";case o.open:return"open";case o.closing:return"closing";default:return"closed"}}},{key:"isConnected",value:function(){return"open"===this.connectionState()}},{key:"remove",value:function(e){this.channels=this.channels.filter(function(n){return n.joinRef()!==e.joinRef()})}},{key:"channel",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=new d(e,n,this);return this.channels.push(t),t}},{key:"push",value:function(e){var n=this,t=e.topic,i=e.event,r=e.payload,o=e.ref,u=e.join_ref,a=function(){n.encode(e,function(e){n.conn.send(e)})};this.log("push",t+" "+i+" ("+u+", "+o+")",r),this.isConnected()?a():this.sendBuffer.push(a)}},{key:"makeRef",value:function(){var e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}},{key:"sendHeartbeat",value:function(){if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void this.conn.close(1e3,"hearbeat timeout");this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef})}}},{key:"flushSendBuffer",value:function(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(function(e){return e()}),this.sendBuffer=[])}},{key:"onConnMessage",value:function(e){var n=this;this.decode(e.data,function(e){var t=e.topic,i=e.event,r=e.payload,o=e.ref,u=e.join_ref;o&&o===n.pendingHeartbeatRef&&(n.pendingHeartbeatRef=null),n.log("receive",(r.status||"")+" "+t+" "+i+" "+(o&&"("+o+")"||""),r),n.channels.filter(function(e){return e.isMember(t,i,r,u)}).forEach(function(e){return e.trigger(i,r,o,u)}),n.stateChangeCallbacks.message.forEach(function(n){return n(e)})})}}]),e}(),e.LongPoll=function(){function e(n){r(this,e),this.endPoint=null,this.token=null,this.skipHeartbeat=!0,this.onopen=function(){},this.onerror=function(){},this.onmessage=function(){},this.onclose=function(){},this.pollEndpoint=this.normalizeEndpoint(n),this.readyState=o.connecting,this.poll()}return i(e,[{key:"normalizeEndpoint",value:function(e){return e.replace("ws://","http://").replace("wss://","https://").replace(new RegExp("(.*)/"+f.websocket),"$1/"+f.longpoll)}},{key:"endpointURL",value:function(){return p.appendParams(this.pollEndpoint,{token:this.token})}},{key:"closeAndRetry",value:function(){this.close(),this.readyState=o.connecting}},{key:"ontimeout",value:function(){this.onerror("timeout"),this.closeAndRetry()}},{key:"poll",value:function(){var e=this;this.readyState!==o.open&&this.readyState!==o.connecting||p.request("GET",this.endpointURL(),"application/json",null,this.timeout,this.ontimeout.bind(this),function(n){if(n){var t=n.status,i=n.token,r=n.messages;e.token=i}else var t=0;switch(t){case 200:r.forEach(function(n){return e.onmessage({data:n})}),e.poll();break;case 204:e.poll();break;case 410:e.readyState=o.open,e.onopen(),e.poll();break;case 0:case 500:e.onerror(),e.closeAndRetry();break;default:throw"unhandled poll status "+t}})}},{key:"send",value:function(e){var n=this;p.request("POST",this.endpointURL(),"application/json",e,this.timeout,this.onerror.bind(this,"timeout"),function(e){e&&200===e.status||(n.onerror(e&&e.status),n.closeAndRetry())})}},{key:"close",value:function(e,n){this.readyState=o.closed,this.onclose()}}]),e}()),p=e.Ajax=function(){function e(){r(this,e)}return i(e,null,[{key:"request",value:function(e,n,t,i,r,o,u){if(window.XDomainRequest){var a=new XDomainRequest;this.xdomainRequest(a,e,n,i,r,o,u)}else{var c=window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");this.xhrRequest(c,e,n,t,i,r,o,u)}}},{key:"xdomainRequest",value:function(e,n,t,i,r,o,u){var a=this;e.timeout=r,e.open(n,t),e.onload=function(){var n=a.parseJSON(e.responseText);u&&u(n)},o&&(e.ontimeout=o),e.onprogress=function(){},e.send(i)}},{key:"xhrRequest",value:function(e,n,t,i,r,o,u,a){var c=this;e.open(n,t,!0),e.timeout=o,e.setRequestHeader("Content-Type",i),e.onerror=function(){a&&a(null)},e.onreadystatechange=function(){if(e.readyState===c.states.complete&&a){var n=c.parseJSON(e.responseText);a(n)}},u&&(e.ontimeout=u),e.send(r)}},{key:"parseJSON",value:function(e){if(!e||""===e)return null;try{return JSON.parse(e)}catch(n){return console&&console.log("failed to parse JSON response",e),null}}},{key:"serialize",value:function(e,t){var i=[];for(var r in e)if(e.hasOwnProperty(r)){var o=t?t+"["+r+"]":r,u=e[r];"object"===(void 0===u?"undefined":n(u))?i.push(this.serialize(u,o)):i.push(encodeURIComponent(o)+"="+encodeURIComponent(u))}return i.join("&")}},{key:"appendParams",value:function(e,n){if(0===Object.keys(n).length)return e;var t=e.match(/\?/)?"&":"?";return""+e+t+this.serialize(n)}}]),e}();p.states={complete:4},e.Presence={syncState:function(e,n,t,i){var r=this,o=this.clone(e),u={},a={};return this.map(o,function(e,t){n[e]||(a[e]=t)}),this.map(n,function(e,n){var t=o[e];if(t){var i=n.metas.map(function(e){return e.phx_ref}),c=t.metas.map(function(e){return e.phx_ref}),s=n.metas.filter(function(e){return c.indexOf(e.phx_ref)<0}),f=t.metas.filter(function(e){return i.indexOf(e.phx_ref)<0});s.length>0&&(u[e]=n,u[e].metas=s),f.length>0&&(a[e]=r.clone(t),a[e].metas=f)}else u[e]=n}),this.syncDiff(o,{joins:u,leaves:a},t,i)},syncDiff:function(e,n,t,i){var r=n.joins,o=n.leaves,u=this.clone(e);return t||(t=function(){}),i||(i=function(){}),this.map(r,function(e,n){var i=u[e];if(u[e]=n,i){var r;(r=u[e].metas).unshift.apply(r,function(e){if(Array.isArray(e)){for(var n=0,t=Array(e.length);n<e.length;n++)t[n]=e[n];return t}return Array.from(e)}(i.metas))}t(e,i,n)}),this.map(o,function(e,n){var t=u[e];if(t){var r=n.metas.map(function(e){return e.phx_ref});t.metas=t.metas.filter(function(e){return r.indexOf(e.phx_ref)<0}),i(e,t,n),0===t.metas.length&&delete u[e]}}),u},list:function(e,n){return n||(n=function(e,n){return n}),this.map(e,function(e,t){return n(e,t)})},map:function(e,n){return Object.getOwnPropertyNames(e).map(function(t){return n(t,e[t])})},clone:function(e){return JSON.parse(JSON.stringify(e))}};var y=function(){function e(n,t){r(this,e),this.callback=n,this.timerCalc=t,this.timer=null,this.tries=0}return i(e,[{key:"reset",value:function(){this.tries=0,clearTimeout(this.timer)}},{key:"scheduleTimeout",value:function(){var e=this;clearTimeout(this.timer),this.timer=setTimeout(function(){e.tries=e.tries+1,e.callback()},this.timerCalc(this.tries+1))}}]),e}()}(n)}));t(gi);gi.Ajax,gi.Channel,gi.LongPoll,gi.Presence,gi.Socket;var wi=function(e){return r(this,void 0),e.map(function(e){var n=e.column,t=e.line;return r(this,void 0),String(t)+":"+String(n)}.bind(this)).join("; ")}.bind(void 0),Oi=function(e){var n=e.message,t=e.locations;return r(this,void 0),n+(t?" ("+String(wi(t))+")":"")}.bind(void 0),ki=function(e){return r(this,void 0),e.map(Oi).join("\n")}.bind(void 0),ji=/^\s*(query|mutation|subscription|\{)/,Ei=function(e){return r(this,void 0),"{"===e?"query":e}.bind(void 0),Si=function(e){r(this,void 0);var n=e.match(ji);if(!n)throw new TypeError("Invalid operation:\n"+String(e));return Ei(n[1])}.bind(void 0),_i=function(e){return r(this,void 0),"OperationDefinition"===e.kind&&"subscription"===e.operation}.bind(void 0),Di=(function(e){return r(this,void 0),e.definitions.some(_i)}.bind(void 0),function(e){var n=e.query,t=e.variables;return r(this,void 0),t?{operation:n,variables:t}:{operation:n}}.bind(void 0),function(e){var n=e.operation,t=e.variables;return r(this,void 0),t?{query:n,variables:t}:{query:n}}.bind(void 0)),Ti=function(e,n,t){return r(this,void 0),e.find(Zt([n],t))}.bind(void 0),Fi=function(e,n){return r(this,void 0),function(t){return r(this,void 0),function(){for(var i=arguments.length,o=Array(i),u=0;u<i;u++)o[u]=arguments[u];r(this,void 0);var a=Ti(e.notifiers,"request",n);a&&t.apply(void 0,[e,a].concat(o))}.bind(this)}.bind(this)}.bind(void 0),Pi=function(e,n,t){return r(this,void 0),ti(Fi(n,t),e)}.bind(void 0),Ai=function(e,n){return r(this,void 0),e.receive("ok",n.onSucceed).receive("error",n.onError).receive("timeout",n.onTimeout)}.bind(void 0),Mi=function(e,n){return r(this,void 0),function(t){return r(this,void 0),t[e]&&t[e](n)}.bind(this)}.bind(void 0),xi=function(e){return r(this,void 0),"on"+String(e)}.bind(void 0),Ii=function(e,n,t){return r(this,void 0),e.observers.forEach(Mi(xi(n),t))}.bind(void 0),Ni=function(e,n,t){return r(this,void 0),e.findIndex(Zt([n],t))}.bind(void 0),Ci=function(e){return r(this,void 0),function(n){return r(this,void 0),Mn(Ni(n,"request",e.request),1,n)}.bind(this)}.bind(void 0),Vi=function(e,n){return r(this,void 0),e.notifiers=n(e.notifiers),e}.bind(void 0),Ri=function(e,n){r(this,void 0),Vi(e,Ci(n)),Ii(n,"Cancel",n)}.bind(void 0),qi={onError:function(e,n,t){r(this,void 0),Li(e,n),Ii(n,"Error","unsubscribe: "+String(t))}.bind(void 0),onTimeout:function(e,n){return r(this,void 0),Ii(n,"Error","unsubscribe: timeout")}.bind(void 0),onSucceed:Ri},Li=function(e,n){return r(this,void 0),Ai(e.channel.push("unsubscribe",{subscriptionId:n.subscriptionId}),Pi(qi,e,n.request))}.bind(void 0),Ji=function(e,n){return r(this,void 0),"subscription"===n.operationType?Li(e,n):Ri(e,n),e}.bind(void 0),Hi=function(e,n,t){return r(this,void 0),e.forEach(function(e){return r(this,void 0),Ii(e,n,t)}.bind(this))}.bind(void 0),Bi=function(e){return r(this,void 0),function(n){return r(this,void 0),xn(Ni(n,"request",e.request),[e],n)}.bind(this)}.bind(void 0),Ki=function(e){return r(this,void 0),Ii(e,"Start",e)}.bind(void 0),Qi=function(e,n,t){var i=t.subscriptionId;r(this,void 0);var o=wn({},n,{subscriptionId:i});Vi(e,Bi(o)),Ki(o)}.bind(void 0),Ui=function(e,n,t){r(this,void 0),Vi(e,Ci(n)),Ii(n,"Abort",t)}.bind(void 0),Gi=function(e,n,t){return r(this,void 0),Ui(e,n,new Error(t))}.bind(void 0),zi=function(e,n,t){r(this,void 0),t.errors?Gi(e,n,ki(t.errors)):Qi(e,n,t)}.bind(void 0),Wi=function(e,n,t){r(this,void 0),Vi(e,Ci(n)),Ii(n,"Result",t)}.bind(void 0),Xi=function(e,n){return r(this,void 0),Ii(n,"Error",new Error("request: timeout"))}.bind(void 0),Yi={onError:Gi,onTimeout:Xi,onSucceed:Wi},$i={onError:Gi,onTimeout:Xi,onSucceed:zi},Zi=function(e,n,t){return r(this,void 0),Ai(e.channel.push("doc",Di(n)),Pi(t,e,n))}.bind(void 0),er=function(e,n){r(this,void 0),"subscription"===n.operationType?Zi(e,n.request,$i):(Ki(n),Zi(e,n.request,Yi))}.bind(void 0),nr=function(e){return r(this,void 0),{onError:function(n){return r(this,void 0),Hi(e.notifiers,"Error",new Error("channel join: "+String(n)))}.bind(this),onSucceed:function(){return r(this,void 0),e.notifiers.forEach(function(n){return r(this,void 0),er(e,n)}.bind(this))}.bind(this),onTimeout:function(){return r(this,void 0),Hi(e.notifiers,"Error",new Error("channel join: timeout"))}.bind(this)}}.bind(void 0),tr=function(e){return r(this,void 0),Ai(e.channel.join(),nr(e)),e.channelJoinCreated=!0,e}.bind(void 0),ir=function(){return r(this,void 0),new Error("connection: close")}.bind(void 0),rr=function(e,n){r(this,void 0),Vi(e,Ci(n)),Ii(n,"Abort",ir())}.bind(void 0),or=function(e){return r(this,void 0),function(n){r(this,void 0),"mutation"===n.operationType?rr(e,n):Ii(n,"Error",ir())}.bind(this)}.bind(void 0),ur=function(e){return r(this,void 0),function(){return r(this,void 0),e.notifiers.forEach(or(e))}.bind(this)}.bind(void 0),ar=function(e,n){var t=n.payload;r(this,void 0);var i=Ti(e.notifiers,"subscriptionId",t.subscriptionId);i&&Ii(i,"Result",t.result)}.bind(void 0),cr=function(e){return r(this,void 0),function(n){r(this,void 0),"subscription:data"===n.event&&ar(e,n)}.bind(this)}.bind(void 0),sr=function(e){return r(this,void 0),!e.channelJoinCreated&&e.notifiers.length>0}.bind(void 0),fr=function(e){return r(this,void 0),function(){r(this,void 0),sr(e)&&tr(e)}.bind(this)}.bind(void 0),lr=(function(e){r(this,void 0);var n={phoenixSocket:e,channel:e.channel("__absinthe__:control"),channelJoinCreated:!1,notifiers:[]};return e.onOpen(fr(n)),e.onMessage(cr(n)),e.onClose(ur(n)),n}.bind(void 0),function(e,n){r(this,void 0);var t=e.observers,i=_n(e,["observers"]);return wn({},i,{observers:[].concat(ln(t),[n])})}.bind(void 0)),dr=function(e,n,t){return r(this,void 0),Vi(e,Bi(lr(n,t)))}.bind(void 0),vr=function(e){return r(this,void 0),{request:e,observers:[],operationType:Si(e.operation),subscriptionId:void 0}}.bind(void 0),hr=function(e){r(this,void 0),e.phoenixSocket.isConnected()?tr(e):e.phoenixSocket.connect()}.bind(void 0),pr=function(e,n){r(this,void 0);var t=vr(n);return Vi(e,Dn([t])),e.channelJoinCreated?er(e,t):hr(e),t}.bind(void 0),yr=function(e,n){return r(this,void 0),Ti(e.notifiers,"request",n)||pr(e,n)}.bind(void 0),mr=function(e,n){return r(this,void 0),function(t){r(this,void 0),n.next(t),"subscription"!==e.operationType&&n.complete()}.bind(this)}.bind(void 0),br=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=t.onError,u=t.onStart,a=t.unsubscribe;return r(this,void 0),new o(function(t){return r(this,void 0),dr(e,n,{onError:i,onStart:u,onAbort:t.error,onResult:mr(n,t)}),a}.bind(this))}.bind(void 0),gr=function(e,n){r(this,void 0);var t=e.observers,i=_n(e,["observers"]);return wn({},i,{observers:Mn(t.indexOf(n),1,t)})}.bind(void 0),wr=(function(e,n,t){return r(this,void 0),Vi(e,Bi(gr(n,t))),e}.bind(void 0),i(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.flip=function(e){return function(n,t){return e(t,n)}},n.constant=function(e){return function(){return e}},n.on=function(e,n){return function(t,i){return e(n(t),n(i))}},n.compose=function(){for(var e=this,n=arguments.length,t=Array(n),i=0;i<n;i++)t[i]=arguments[i];var r=t.length-1;return function(n){for(var i=n,o=r;o>-1;o--)i=t[o].call(e,i);return i}},n.pipe=function(){for(var e=this,n=arguments.length,t=Array(n),i=0;i<n;i++)t[i]=arguments[i];var r=t.length-1;return function(n){for(var i=n,o=0;o<=r;o++)i=t[o].call(e,i);return i}},n.curry=function(e){return function e(n,t,i){return function(){var r=i.concat(Array.prototype.slice.call(arguments));return r.length>=t?n.apply(this,r):e(n,t,r)}}(e,e.length,[])}}));t(wr);wr.flip,wr.constant,wr.on;var Or=wr.compose,kr=(wr.pipe,wr.curry,function(e){var n=e.query,t=e.variables;return r(this,void 0),{operation:O(n),variables:t}}.bind(void 0)),jr=function(e,n,t){return r(this,void 0),function(i){r(this,void 0);var o=void 0,u=!1;return br(e,i,{onError:n,onStart:function(n){r(this,void 0),o=n,u&&Ji(e,o),t&&t(n)}.bind(this),unsubscribe:function(){r(this,void 0),u=!0,o&&Ji(e,o)}.bind(this)})}.bind(this)}.bind(void 0),Er=function(e,n,t){return r(this,void 0),new P(Or(jr(e,n,t),function(n){return r(this,void 0),yr(e,n)}.bind(this),kr))}.bind(void 0);e.createAbsintheSocketLink=Er,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=index.js.map
